<% content_for :page_title do %>학부모 대시보드<% end %>

<!-- Page Header -->
<div class="rp-page-header">
  <h1 class="rp-page-header__title">학부모 대시보드</h1>
  <p class="rp-page-header__subtitle">자녀의 진단 결과와 학습 흐름을 한눈에 확인하세요.</p>
</div>

<!-- Child Selector -->
<% if @selected_student %>
  <div class="rp-card rp-mb-6">
    <div class="rp-flex rp-items-center rp-justify-between">
      <div class="rp-flex rp-items-center rp-gap-4">
        <div class="rp-avatar" style="width: 48px; height: 48px; font-size: 18px;"><%= @selected_student.name.first %></div>
        <div>
          <h3 style="margin: 0; font-weight: 600; color: var(--rp-text-title);"><%= @selected_student.name %></h3>
          <p class="rp-text-muted" style="margin: 0; font-size: 13px;"><%= @selected_student.school&.name || "학교" %> <%= @selected_student.grade || "학년" %></p>
        </div>
        <span class="rp-badge rp-badge--success">활동 중</span>
      </div>
      <div class="rp-flex rp-gap-2">
        <% if @students.count > 1 %>
          <select class="rp-select" style="width: 180px;" onchange="window.location.href='<%= parent_dashboard_path %>?student_id=' + this.value">
            <% @students.each do |student| %>
              <option value="<%= student.id %>" <%= 'selected' if student.id == @selected_student.id %>>
                <%= student.name %>
              </option>
            <% end %>
          </select>
        <% end %>
        <a href="<%= parent_forums_path %>" class="rp-btn rp-btn--primary">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"></path>
          </svg>
          공유 게시판
        </a>
      </div>
    </div>
  </div>
<% end %>

<!-- Stats Grid -->
<div class="rp-grid rp-grid--4 rp-stagger rp-mb-6">
  <div class="rp-stat">
    <div class="rp-stat__label">종합 등급</div>
    <div class="rp-stat__value" style="color: var(--rp-success);">B+</div>
    <div class="rp-stat__trend rp-stat__trend--up">+1등급</div>
  </div>
  <div class="rp-stat">
    <div class="rp-stat__label">최근 진단일</div>
    <div class="rp-stat__value">01/20</div>
    <div class="rp-stat__trend">2026년</div>
  </div>
  <div class="rp-stat">
    <div class="rp-stat__label">완료 진단</div>
    <div class="rp-stat__value">8건</div>
    <div class="rp-stat__trend">누적</div>
  </div>
  <div class="rp-stat">
    <div class="rp-stat__label">피드백 수</div>
    <div class="rp-stat__value">5건</div>
    <div class="rp-stat__trend">이번 학기</div>
  </div>
</div>

<!-- Main Content -->
<div class="rp-grid rp-grid--2 rp-mb-6">
  <!-- Diagnosis Result -->
  <div class="rp-card">
    <div class="rp-card__header">
      <div>
        <h3 class="rp-card__title">진단 결과 요약</h3>
        <p class="rp-card__subtitle">최근 3회 진단 평균</p>
      </div>
      <span class="rp-badge rp-badge--info">최신</span>
    </div>
    <div class="rp-card__body">
      <div class="rp-chart-placeholder" style="height: 140px;">
        <div class="rp-chart-bar" style="height: 78%;"></div>
        <div class="rp-chart-bar" style="height: 65%;"></div>
        <div class="rp-chart-bar" style="height: 72%;"></div>
      </div>
      <div class="rp-flex rp-gap-2 rp-mt-4" style="flex-wrap: wrap;">
        <span class="rp-badge rp-badge--primary">이해력 78점</span>
        <span class="rp-badge rp-badge--info">의사소통 65점</span>
        <span class="rp-badge rp-badge--success">심미적 감수성 72점</span>
      </div>
    </div>
    <div class="rp-card__footer">
      <a href="/parent/reports" class="rp-btn rp-btn--secondary rp-btn--sm">
        상세 리포트 보기
      </a>
      <a href="#" class="rp-btn rp-btn--ghost rp-btn--sm">
        PDF 다운로드
      </a>
    </div>
  </div>

  <!-- Recent Activity -->
  <div class="rp-card">
    <div class="rp-card__header">
      <h3 class="rp-card__title">최근 활동</h3>
    </div>
    <div class="rp-card__body">
      <div class="rp-table-wrapper">
        <table class="rp-table">
          <tbody>
            <tr>
              <td>
                <strong>읽기 진단 완료</strong>
                <div class="rp-text-muted" style="font-size: 12px;">종합 B+ 등급 획득</div>
              </td>
              <td class="rp-text-right">
                <span class="rp-badge rp-badge--success">오늘</span>
              </td>
            </tr>
            <tr>
              <td>
                <strong>「시간을 달리는 소녀」 완독</strong>
                <div class="rp-text-muted" style="font-size: 12px;">감상문 작성 중</div>
              </td>
              <td class="rp-text-right">
                <span class="rp-badge rp-badge--default">어제</span>
              </td>
            </tr>
            <tr>
              <td>
                <strong>피드백 확인</strong>
                <div class="rp-text-muted" style="font-size: 12px;">문장 표현 개선 권장</div>
              </td>
              <td class="rp-text-right">
                <span class="rp-badge rp-badge--default">3일 전</span>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>

<!-- Info Banner -->
<div class="rp-ai-coach">
  <div class="rp-ai-coach__header">
    <svg class="rp-ai-coach__icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
      <circle cx="12" cy="12" r="10"></circle>
      <path d="M12 16v-4M12 8h.01"></path>
    </svg>
    <span class="rp-ai-coach__title">ReadingPRO 안내</span>
  </div>
  <div class="rp-ai-coach__content">
    AI 기반 진단과 맞춤형 피드백으로 자녀의 읽기 성장을 지원합니다.
    정기적인 진단 참여와 결과 확인을 통해 자녀의 독서 역량 변화를 추적해보세요.
  </div>
  <div class="rp-ai-coach__actions">
    <a href="/parent/reports" class="rp-btn rp-btn--primary rp-btn--sm">리포트 확인</a>
    <a href="#" class="rp-btn rp-btn--secondary rp-btn--sm">도움말</a>
  </div>
</div>
