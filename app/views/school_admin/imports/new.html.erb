<% content_for :portal_title do %>
  학생 일괄 등록
<% end %>
<% content_for :portal_subtitle do %>
  엑셀 파일을 업로드하여 학생과 학부모 계정을 일괄 생성합니다.
<% end %>
<% content_for :portal_nav do %>
  <%= render "school_admin/shared/nav", current: :students %>
<% end %>

<section class="portal-card" style="margin-bottom: 24px;">
  <h2 class="portal-card-title">엑셀 파일 업로드</h2>

  <% if @errors.present? %>
    <div style="background: #fef2f2; border: 1px solid #fecaca; border-radius: 8px; padding: 16px; margin-bottom: 20px;">
      <h4 style="margin: 0 0 8px 0; color: #991b1b; font-size: 14px;">오류가 발생했습니다</h4>
      <ul style="margin: 0; padding-left: 20px; color: #991b1b; font-size: 13px;">
        <% @errors.each do |error| %>
          <li><%= error %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <div style="margin-bottom: 24px;">
    <p style="font-size: 14px; color: #475569; margin: 0 0 12px 0;">
      먼저 템플릿을 다운로드하여 학생 정보를 입력한 후 업로드해주세요.
    </p>
    <%= link_to "템플릿 다운로드",
          template_school_admin_imports_path,
          style: "display: inline-block; padding: 10px 20px; background: #10b981; color: white; border-radius: 6px; font-size: 14px; font-weight: 500; text-decoration: none;" %>
  </div>

  <%= form_with url: school_admin_imports_path, method: :post, multipart: true, local: true, data: { turbo: false } do %>
    <div style="margin-bottom: 16px;">
      <label style="display: block; font-weight: 500; color: #374151; margin-bottom: 8px; font-size: 14px;">엑셀 파일 (xlsx, xls, csv)</label>
      <input type="file" name="file" accept=".xlsx,.xls,.csv" required
             style="padding: 8px; border: 1px solid #d1d5db; border-radius: 6px; font-size: 14px; width: 100%;">
    </div>

    <button type="submit"
            style="padding: 12px 24px; background: #2f5bff; color: white; border: none; border-radius: 8px; font-size: 16px; font-weight: 600; cursor: pointer;">
      업로드 및 등록
    </button>
  <% end %>
</section>

<section class="portal-card">
  <h2 class="portal-card-title">입력 안내</h2>
  <div style="font-size: 14px; color: #475569; line-height: 1.8;">
    <table style="width: 100%; border-collapse: collapse;">
      <thead>
        <tr style="background: #f8fafc; border-bottom: 2px solid #e2e8f0;">
          <th style="padding: 10px 12px; text-align: left; font-size: 13px; color: #475569;">컬럼</th>
          <th style="padding: 10px 12px; text-align: left; font-size: 13px; color: #475569;">필수</th>
          <th style="padding: 10px 12px; text-align: left; font-size: 13px; color: #475569;">설명</th>
        </tr>
      </thead>
      <tbody>
        <tr style="border-bottom: 1px solid #e2e8f0;">
          <td style="padding: 8px 12px;"><strong>student_name</strong></td>
          <td style="padding: 8px 12px; color: #dc2626;">필수</td>
          <td style="padding: 8px 12px;">학생 이름</td>
        </tr>
        <tr style="border-bottom: 1px solid #e2e8f0;">
          <td style="padding: 8px 12px;"><strong>grade</strong></td>
          <td style="padding: 8px 12px; color: #dc2626;">필수</td>
          <td style="padding: 8px 12px;">학년 (숫자)</td>
        </tr>
        <tr style="border-bottom: 1px solid #e2e8f0;">
          <td style="padding: 8px 12px;"><strong>class_name</strong></td>
          <td style="padding: 8px 12px; color: #dc2626;">필수</td>
          <td style="padding: 8px 12px;">반</td>
        </tr>
        <tr style="border-bottom: 1px solid #e2e8f0;">
          <td style="padding: 8px 12px;"><strong>student_number</strong></td>
          <td style="padding: 8px 12px; color: #dc2626;">필수</td>
          <td style="padding: 8px 12px;">학번</td>
        </tr>
        <tr style="border-bottom: 1px solid #e2e8f0;">
          <td style="padding: 8px 12px;"><strong>student_email</strong></td>
          <td style="padding: 8px 12px; color: #dc2626;">필수</td>
          <td style="padding: 8px 12px;">학생 이메일 (로그인용)</td>
        </tr>
        <tr style="border-bottom: 1px solid #e2e8f0;">
          <td style="padding: 8px 12px;"><strong>parent_name</strong></td>
          <td style="padding: 8px 12px; color: #94a3b8;">선택</td>
          <td style="padding: 8px 12px;">학부모 이름</td>
        </tr>
        <tr style="border-bottom: 1px solid #e2e8f0;">
          <td style="padding: 8px 12px;"><strong>parent_email</strong></td>
          <td style="padding: 8px 12px; color: #94a3b8;">선택</td>
          <td style="padding: 8px 12px;">학부모 이메일 (로그인용)</td>
        </tr>
        <tr>
          <td style="padding: 8px 12px;"><strong>relationship</strong></td>
          <td style="padding: 8px 12px; color: #94a3b8;">선택</td>
          <td style="padding: 8px 12px;">학생과의 관계 (기본값: 부모)</td>
        </tr>
      </tbody>
    </table>
  </div>
</section>
