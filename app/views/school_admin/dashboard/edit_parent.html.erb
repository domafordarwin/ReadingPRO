<% content_for :portal_title do %>
  학부모 정보 수정
<% end %>
<% content_for :portal_subtitle do %>
  <%= @parent.name %>의 정보를 수정합니다.
<% end %>
<% content_for :portal_nav do %>
  <%= render "school_admin/shared/nav", current: :parents %>
<% end %>

<section class="portal-card" style="max-width: 500px;">
  <% if @parent.errors.any? %>
    <div style="background: #fef2f2; border: 1px solid #fecaca; color: #991b1b; padding: 12px 16px; border-radius: 8px; margin-bottom: 16px;">
      <strong>오류:</strong>
      <ul style="margin: 8px 0 0 16px;">
        <% @parent.errors.full_messages.each do |msg| %>
          <li><%= msg %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <%= form_with model: @parent, url: school_admin_update_parent_path(@parent), method: :patch, local: true, data: { turbo: false } do |f| %>
    <div style="margin-bottom: 16px;">
      <%= f.label :name, "학부모 ID", style: "display: block; font-weight: var(--rp-font-weight-medium); color: #0f172a; margin-bottom: 6px; font-size: var(--rp-font-size-base);" %>
      <%= f.text_field :name, style: "width: 100%; padding: 10px 12px; border: 1px solid #cbd5e1; border-radius: 6px; font-size: var(--rp-font-size-base);", readonly: true %>
      <p style="font-size: var(--rp-font-size-xs); color: #94a3b8; margin-top: 4px;">학부모 ID는 변경할 수 없습니다.</p>
    </div>

    <div style="margin-bottom: 16px;">
      <%= f.label :phone, "연락처", style: "display: block; font-weight: var(--rp-font-weight-medium); color: #0f172a; margin-bottom: 6px; font-size: var(--rp-font-size-base);" %>
      <%= f.text_field :phone, style: "width: 100%; padding: 10px 12px; border: 1px solid #cbd5e1; border-radius: 6px; font-size: var(--rp-font-size-base);", placeholder: "예: 010-1234-5678" %>
    </div>

    <div style="margin-bottom: 16px;">
      <label style="display: block; font-weight: var(--rp-font-weight-medium); color: #0f172a; margin-bottom: 6px; font-size: var(--rp-font-size-base);">이메일</label>
      <input type="email" value="<%= @parent.user&.email %>" style="width: 100%; padding: 10px 12px; border: 1px solid #cbd5e1; border-radius: 6px; font-size: var(--rp-font-size-base); background: #f8fafc;" readonly>
    </div>

    <div style="margin-bottom: 16px;">
      <label style="display: block; font-weight: var(--rp-font-weight-medium); color: #0f172a; margin-bottom: 6px; font-size: var(--rp-font-size-base);">연결 학생</label>
      <% @parent.students.each do |student| %>
        <span style="display: inline-block; padding: 4px 12px; background: #dcfce7; color: #166534; border-radius: 20px; font-size: var(--rp-font-size-sm); font-weight: var(--rp-font-weight-semibold); margin-right: 4px;"><%= student.name %></span>
      <% end %>
    </div>

    <div style="display: flex; gap: 8px; margin-top: 24px;">
      <%= f.submit "저장", style: "padding: 10px 16px; background: #2f5bff; color: white; border: none; border-radius: 6px; font-size: var(--rp-font-size-base); font-weight: var(--rp-font-weight-medium); cursor: pointer;" %>
      <%= link_to "취소", school_admin_parents_path, style: "padding: 10px 16px; background: #f1f5f9; color: #64748b; border: 1px solid #cbd5e1; border-radius: 6px; font-size: var(--rp-font-size-base); text-decoration: none;" %>
    </div>
  <% end %>
</section>
