<div class="rp-container" style="padding: 20px;">
  <h1>π› λ΅μ»¬ μ›Ή νμ΄μ§€ μ¤λ¥ λ¶„μ„</h1>

  <!-- μ”μ•½ ν†µκ³„ -->
  <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 16px; margin: 20px 0;">
    <div class="rp-card">
      <div class="rp-card__body">
        <div style="color: #666; font-size: 12px;">μ „μ²΄ λ―Έν•΄κ²° μ—λ¬</div>
        <div style="font-size: 28px; font-weight: bold;"><%= @summary[:unresolved_count] %></div>
      </div>
    </div>

    <div class="rp-card">
      <div class="rp-card__body">
        <div style="color: #666; font-size: 12px;">μ¤λμ μ—λ¬</div>
        <div style="font-size: 28px; font-weight: bold;"><%= @summary[:today_count] %></div>
      </div>
    </div>

    <div class="rp-card">
      <div class="rp-card__body">
        <div style="color: #666; font-size: 12px;">μ—λ¬ μ ν•</div>
        <div style="font-size: 28px; font-weight: bold;"><%= @error_types.count %></div>
      </div>
    </div>

    <div class="rp-card">
      <div class="rp-card__body">
        <div style="color: #666; font-size: 12px;">λ¬Έμ  νμ΄μ§€</div>
        <div style="font-size: 28px; font-weight: bold;"><%= @pages_with_errors.count %></div>
      </div>
    </div>
  </div>

  <!-- μ—λ¬ μ ν•λ³„ λ¶„ν¬ -->
  <div class="rp-card" style="margin-bottom: 20px;">
    <div class="rp-card__header">
      <h2>π“ μ—λ¬ μ ν•λ³„ λ¶„ν¬</h2>
    </div>
    <div class="rp-card__body">
      <% if @error_types.any? %>
        <% @error_types.sort_by { |_, count| -count }.each do |type, count| %>
          <div style="margin-bottom: 10px; display: flex; justify-content: space-between; align-items: center;">
            <span><strong><%= type %></strong></span>
            <div style="flex: 1; margin: 0 20px;">
              <div style="background: #eee; height: 20px; border-radius: 4px;">
                <div style="background: #ff6b6b; height: 100%; width: <%= (count.to_f / @error_types.values.max * 100).round %>%; border-radius: 4px;"></div>
              </div>
            </div>
            <span style="color: #666;"><%= count %> κ±΄</span>
          </div>
        <% end %>
      <% else %>
        <p style="color: #666;">μ—λ¬κ°€ μ—†μµλ‹λ‹¤! β¨</p>
      <% end %>
    </div>
  </div>

  <!-- λ¬Έμ κ°€ μλ” νμ΄μ§€ -->
  <div class="rp-card" style="margin-bottom: 20px;">
    <div class="rp-card__header">
      <h2>π”΄ λ¬Έμ  νμ΄μ§€</h2>
    </div>
    <div class="rp-card__body">
      <% if @pages_with_errors.any? %>
        <% @pages_with_errors.sort_by { |_, count| -count }.each do |page, count| %>
          <div style="padding: 10px; margin-bottom: 10px; background: #f9f9f9; border-left: 4px solid #ff6b6b; border-radius: 4px;">
            <div style="font-weight: bold;"><%= page %></div>
            <div style="color: #666; font-size: 12px;"><%= count %> κ±΄μ μ—λ¬</div>
          </div>
        <% end %>
      <% else %>
        <p style="color: #666;">λ¨λ“  νμ΄μ§€κ°€ μ •μƒμ…λ‹λ‹¤! β¨</p>
      <% end %>
    </div>
  </div>

  <!-- μµκ·Ό μ—λ¬ λ©λ΅ -->
  <div class="rp-card">
    <div class="rp-card__header">
      <h2>π” λ―Έν•΄κ²° μ—λ¬ (24μ‹κ°„)</h2>
    </div>
    <div class="rp-card__body">
      <% if @errors.any? %>
        <table style="width: 100%; border-collapse: collapse;">
          <thead>
            <tr style="border-bottom: 2px solid #ddd;">
              <th style="text-align: left; padding: 10px;">μ‹κ°„</th>
              <th style="text-align: left; padding: 10px;">μ—λ¬ νƒ€μ…</th>
              <th style="text-align: left; padding: 10px;">λ©”μ‹μ§€</th>
              <th style="text-align: left; padding: 10px;">νμ΄μ§€</th>
              <th style="text-align: left; padding: 10px;">μ‘μ—…</th>
            </tr>
          </thead>
          <tbody>
            <% @errors.each do |error| %>
              <tr style="border-bottom: 1px solid #eee;">
                <td style="padding: 10px; white-space: nowrap; font-size: 12px;"><%= time_ago_in_words(error.created_at) %> μ „</td>
                <td style="padding: 10px; font-size: 12px;"><span style="background: #fee; color: #c33; padding: 2px 8px; border-radius: 3px;"><%= error.error_type %></span></td>
                <td style="padding: 10px; font-size: 12px;">
                  <%= link_to truncate(error.message, length: 50), error_analyzer_path(error) %>
                </td>
                <td style="padding: 10px; font-size: 12px;"><%= error.page_path %></td>
                <td style="padding: 10px;">
                  <%= link_to 'μƒμ„Έ', error_analyzer_path(error), class: 'rp-btn rp-btn--ghost', style: 'font-size: 12px; padding: 4px 8px;' %>
                  <%= link_to 'ν•΄κ²°', mark_resolved_path(error), method: :patch, class: 'rp-btn rp-btn--success', style: 'font-size: 12px; padding: 4px 8px;' %>
                </td>
              </tr>
            <% end %>
          </tbody>
        </table>

        <!-- νμ΄μ§€λ„¤μ΄μ… -->
        <div style="margin-top: 20px; text-align: center;">
          <%= paginate @errors %>
        </div>
      <% else %>
        <p style="color: #666; text-align: center; padding: 20px;">λ¨λ“  μ—λ¬κ°€ ν•΄κ²°λμ—μµλ‹λ‹¤! π‰</p>
      <% end %>
    </div>
  </div>
</div>
