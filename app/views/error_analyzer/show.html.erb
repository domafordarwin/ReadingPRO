<div class="rp-container" style="padding: 20px;">
  <%= link_to 'β† λμ•„κ°€κΈ°', error_analyzer_path, class: 'rp-btn rp-btn--ghost' %>

  <div class="rp-card" style="margin-top: 20px;">
    <div class="rp-card__header">
      <h1>π› μ—λ¬ μƒμ„Έ λ¶„μ„</h1>
    </div>

    <div class="rp-card__body">
      <!-- κΈ°λ³Έ μ •λ³΄ -->
      <div style="background: #f9f9f9; padding: 20px; border-radius: 8px; margin-bottom: 20px;">
        <h3 style="margin: 0 0 15px 0;">κΈ°λ³Έ μ •λ³΄</h3>

        <div style="display: grid; grid-template-columns: 200px 1fr; gap: 20px;">
          <div>
            <div style="color: #666; font-size: 12px;">μ—λ¬ μ ν•</div>
            <div style="font-weight: bold; font-size: 16px;"><span style="background: #fee; color: #c33; padding: 4px 8px; border-radius: 3px;"><%= @error.error_type %></span></div>
          </div>

          <div>
            <div style="color: #666; font-size: 12px;">λ°μƒ μ‹κ°„</div>
            <div style="font-weight: bold; font-size: 16px;"><%= @error.created_at.strftime('%Y-%m-%d %H:%M:%S') %></div>
          </div>

          <div>
            <div style="color: #666; font-size: 12px;">νμ΄μ§€</div>
            <div style="font-weight: bold; font-size: 14px;"><%= @error.page_path %></div>
          </div>

          <div>
            <div style="color: #666; font-size: 12px;">HTTP λ©”μ„λ“</div>
            <div style="font-weight: bold; font-size: 14px;"><span style="background: #e3f2fd; color: #1976d2; padding: 2px 8px; border-radius: 3px;"><%= @error.http_method %></span></div>
          </div>

          <div>
            <div style="color: #666; font-size: 12px;">IP μ£Όμ†</div>
            <div style="font-weight: bold; font-size: 14px;"><%= @error.ip_address %></div>
          </div>

          <div>
            <div style="color: #666; font-size: 12px;">μƒνƒ</div>
            <div style="font-weight: bold; font-size: 14px;">
              <% if @error.resolved %>
                <span style="background: #d4edda; color: #155724; padding: 4px 8px; border-radius: 3px;">β… ν•΄κ²°λ¨</span>
              <% else %>
                <span style="background: #f8d7da; color: #721c24; padding: 4px 8px; border-radius: 3px;">π”΄ λ―Έν•΄κ²°</span>
              <% end %>
            </div>
          </div>
        </div>
      </div>

      <!-- μ—λ¬ λ©”μ‹μ§€ -->
      <div style="margin-bottom: 20px;">
        <h3>μ—λ¬ λ©”μ‹μ§€</h3>
        <pre style="background: #f5f5f5; padding: 15px; border-radius: 4px; overflow-x: auto; font-size: 12px;"><%= @error.message %></pre>
      </div>

      <!-- λ°±νΈλ μ΄μ¤ -->
      <% if @error.backtrace %>
        <div style="margin-bottom: 20px;">
          <h3>μ¤νƒ νΈλ μ΄μ¤</h3>
          <pre style="background: #f5f5f5; padding: 15px; border-radius: 4px; overflow-x: auto; font-size: 11px;"><%= @error.backtrace %></pre>
        </div>
      <% end %>

      <!-- μ”μ²­ νλΌλ―Έν„° -->
      <% if @error.params.present? %>
        <div style="margin-bottom: 20px;">
          <h3>μ”μ²­ νλΌλ―Έν„°</h3>
          <pre style="background: #f5f5f5; padding: 15px; border-radius: 4px; overflow-x: auto; font-size: 11px;"><%= JSON.pretty_generate(@error.params) %></pre>
        </div>
      <% end %>

      <!-- ν–‰λ™ -->
      <div style="margin-top: 30px;">
        <% if !@error.resolved %>
          <%= link_to 'β… ν•΄κ²°λ΅ ν‘μ‹', mark_resolved_path(@error), method: :patch, class: 'rp-btn rp-btn--success' %>
        <% end %>
        <%= link_to 'μ‚­μ ', @error, method: :delete, data: { confirm: 'μ •λ§ μ‚­μ ν•μ‹κ² μµλ‹κΉ?' }, class: 'rp-btn rp-btn--danger' %>
      </div>
    </div>
  </div>

  <!-- μ μ‚¬ν• μ—λ¬ -->
  <% if @similar_errors.any? %>
    <div class="rp-card" style="margin-top: 20px;">
      <div class="rp-card__header">
        <h2>π“ κ°™μ€ νƒ€μ…μ μµκ·Ό μ—λ¬ (<%= @similar_errors.count %>κ°)</h2>
      </div>

      <div class="rp-card__body">
        <table style="width: 100%; border-collapse: collapse;">
          <thead>
            <tr style="border-bottom: 2px solid #ddd;">
              <th style="text-align: left; padding: 10px;">μ‹κ°„</th>
              <th style="text-align: left; padding: 10px;">λ©”μ‹μ§€</th>
              <th style="text-align: left; padding: 10px;">νμ΄μ§€</th>
            </tr>
          </thead>
          <tbody>
            <% @similar_errors.each do |error| %>
              <tr style="border-bottom: 1px solid #eee;">
                <td style="padding: 10px; font-size: 12px;"><%= time_ago_in_words(error.created_at) %> μ „</td>
                <td style="padding: 10px; font-size: 12px;">
                  <%= link_to truncate(error.message, length: 50), error_analyzer_path(error) %>
                </td>
                <td style="padding: 10px; font-size: 12px;"><%= error.page_path %></td>
              </tr>
            <% end %>
          </tbody>
        </table>
      </div>
    </div>
  <% end %>
</div>
