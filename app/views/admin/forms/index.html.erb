<header class="admin-header">
  <div>
    <h1 class="admin-title">시험지 관리</h1>
    <p class="admin-subtitle">시험지를 구성하고 배점을 설정하세요</p>
  </div>
  <div class="admin-actions">
    <%= link_to "새 시험지", new_admin_form_path, class: "admin-button primary" %>
  </div>
</header>

<section class="admin-card">
  <% if @forms.any? %>
    <table class="admin-table">
      <thead>
        <tr>
          <th>제목</th>
          <th>상태</th>
          <th>문항 수</th>
          <th>총점</th>
          <th>응시 수</th>
          <th>관리</th>
        </tr>
      </thead>
      <tbody>
        <% @forms.each do |form| %>
          <tr>
            <td><%= form.title %></td>
            <td><span class="admin-badge"><%= form.status %></span></td>
            <td><%= form.form_items.size %></td>
            <td><%= form.form_items.sum(&:points) %></td>
            <td><%= form.attempts.size %></td>
            <td>
              <div class="admin-actions">
                <%= link_to "상세", admin_form_path(form), class: "admin-button" %>
                <%= link_to "수정", edit_admin_form_path(form), class: "admin-button" %>
              </div>
            </td>
          </tr>
        <% end %>
      </tbody>
    </table>
  <% else %>
    <p class="admin-muted">등록된 시험지가 없습니다.</p>
  <% end %>
</section>

<section class="admin-card">
  <h2>시험지 문항 구성</h2>
  <% if @current_form.present? %>
    <p class="admin-muted"><%= @current_form.title %></p>
    <% if @form_items.any? %>
      <table class="admin-table">
        <thead>
          <tr>
            <th>순서</th>
            <th>문항코드</th>
            <th>유형</th>
            <th>문항</th>
            <th>배점</th>
          </tr>
        </thead>
        <tbody>
          <% @form_items.each do |form_item| %>
            <tr>
              <td><%= form_item.position %></td>
              <td><%= form_item.item.code %></td>
              <td><%= form_item.item.item_type %></td>
              <td><%= truncate(form_item.item.prompt, length: 80) %></td>
              <td><%= form_item.points %></td>
            </tr>
          <% end %>
        </tbody>
      </table>
    <% else %>
      <p class="admin-muted">문항이 아직 연결되지 않았습니다.</p>
    <% end %>
  <% else %>
    <p class="admin-muted">표시할 시험지가 없습니다.</p>
  <% end %>
</section>
